# 技術力評価会　評価結果

* 被評価者: DIGITALIO 小林 彩花
* 評価者: CARTA MARKETING FIRM 南大津 寛

[評価資料](./)


## 総評

インフルエンサー経由でECナビの案件の成果発生を増加させるための施策であるデジコキャンペーンに関して、既存の課題を解消させてより広く拡販していくために、インフルエンサー向けの管理画面を外部サービスも活用しながら作成したお話でした。

背景などビジネス的な観点で気になった所をいくつか質問させてもらいましたが、いずれも納得感のある回答を得ることでき、よく理解できているなと思いました。ビジネスサイドが感じていた課題に関しても、具体的な作業ベースまで把握できていて良かったです。  
今までポイントメディアに携わってきた知見も活かして、要注意ポイントを気にしながら開発を進められていました。実現したいことを相談すれば、本当に必要なものを考えて、しっかり作り切ってくれるだろうという、対応を任せられる安心感を感じました。

設計レビューを小さい所属チームに閉じず、部署エンジニア全体に対して開かれたレビュー会を実施していたのはいい動きだなと思いました。結果としては、今回はアフィリエイトユニット所属のチームメンバーしか参加はできなかったそうですが、意識的にそういう動きをすることで得られる知見もあると思うので継続するといいと思います。場合によってはこの人には参加してほしい、というのを指名してもいいかもしれないですね。

インフルエンサーに提供する管理画面に関して、内製するのではなく、外部サービスのAFADを活用したことに関しては、目先の工数に囚われて安易な選択となっていないか気にしていましたが、評価会中の話を聞く限り、悪くない選択だったのかなと思いました。外部サービスに依存することになるので、場合によっては将来機能追加をしたくなった際に足枷になることもあると思いますが、今回のケースにおいては現状の機能（案件情報の確認、成果レポート）があれば必要十分そうに思えました。  
AFADの開発会社とのやり取りは、先方のレスポンスが遅く苦労したとのことでしたが、そこに対するアクションも適切だったと思います。より踏み込むとしたら、先方の対応が期待通りでないと感じたタイミングで、お互いの期待値の認識をすり合わせる場を設けておくと、期待とずれたときの先方側のアクションがスピード感を持って進めてもらえたかもなと思います。

全体を通して、特に気になった点としてはスケジュール周りです。IssueやPRになるべく早く終わらせることを優先するようなコメントが複数見受けられました。  
期限まであまり時間がなかったということですが、期限は着手のタイミングで動かせない状態で決まっていたわけではなく、開発ボリュームなどを確認した後にエンジニア観点も加味して決めていたようなので、もう少し期限に追われる形ではなく進められると良かったと思います。具体的に自分だったらこうするかなというのは後述します。「質は速さ」を体現していきましょう！

課題感のある既存のバッチサーバにバッチ処理を載せた所も、スケジュールを優先した結果だと認識していますが、もう少し未来を見据えられていると良かったと思いました。  
AWSのサービスに乗せ換えられる良さそうという話は出ていましたが、もう少し解像度高くこういう方針で乗せ換えていく、という所まで考えが深められていると納得感や安心感があります。  
欲を言うとバッチサーバ全体の未来に対しても、主体的に方針を考えられてるとすごいな！となったと思います。自身だけで方針を決める必要はなく、まずは改めてチーム内で問題提議する所からでもいいと思うので、課題をそのままにしない姿勢を持てるとよいのではと思いました。

バッチ処理そのものは、自動リトライなど運用のことを考えた工夫が見られました。工夫はとても良いと思う一方、これもAWSのサービスを活用する手もあったと思うので、後述します。

まだ施策としては土壌が整った段階で、成果が出るのはこれからというタイミングでの評価会だったので、今後施策として伸びていくことを期待しつつ、より伸ばすための改善施策があればまた力を発揮していってほしいなと思いました。


## 評価者が被評価者の状況ならこう考える、こう動く

### スケジュールに余裕や調整の余地を残す

- 開発中にスケジュールに余裕がなくなると、検証や調査に時間を避けず、どうしても時間を優先した選択をしてしまい、誰しも最適な設計や技術選定からはずれてしまいがち。
- 特に外部パートナーが絡む場合、不確定要素が大きいので、当初の想定からずれることが多い。
- 極力時間に余裕がない状況を生み出さないように工夫をする。
  - 1ヶ月を超えるような規模の開発の場合、初期段階ではざっくりとした目安に留めておいて、開発を進めるに従って完了目安日の確度をあげていく。
    - 外部が絡む場合は通常以上に余裕を持って考える。
    - ビジネスサイドともそれで問題がないように調整をする。外部への事前告知が必要な場合、開発完了目安日の確度があがるまで待ってもらう。あるいはあくまで予定であり、ずれる可能性があることを握っておく。
  - どうしても動かせない締切がある場合、細かく開発タスクの洗い出しとスケジュールを引いて、想定通りに進んでいない状況に早めに気付けるようにする。
    - そうすることで早めにアラートをあげて周囲の協力を得るなどのアクションに繋げることができる。
- 時間を優先して後からやると判断したことは、漏れが出ないようにリストアップしたり、Issueを立てておく。


### AFADへの通知処理は既存のバッチサーバではなく、Lambdaで実装する

- SQSフックでLambdaでの通知処理を実行する形式
  - あやかちゃんも検討はしていた。
  - 課題感のあるところに処理を追加するのは、負債を増やしていることになるので、本当にそれで良いのか考えたい。
    - 今回のケースにおいてはバッチサーバよりもLambdaで実装する方がメリットが上回ると感じた。
    - バッチサーバで実装する場合、現状の課題感に対して明確な対応方針を示せる状態にはしておきたい。
- メリット
  - 現状課題感があるバッチサーバインフラの管理が不要になる。
    - 他に同様のLambda処理がなければ、今後バッチサーバから脱却する際の参考になる。
  - リトライ、リカバリーがより簡単になる。
    - リトライはSQSの可視性タイムアウトと最大受信回数でよしなに。リカバリーは通常DeadLetterQueueから再処理するだけでよい。
  - リアルタイム性があがる。
    - 今回の要件的には不要という話ではあったけど、反映が早い方が嬉しい部分もありそう。
  - 通知済みかどうかのDB管理を不要にできそう。
  - AFAD側の障害などで大量に失敗した場合でも、DLQのみを監視していればSlackに通知されるアラートの数が抑制できて、対応時の混乱が抑えられる。


### 提供しているものが想定外の使い方をされても問題が発生しないように考慮する

評価会中にも議論させてもらいましたが

- 現状のLPの設計では、成果の連携やユーザへのインセンティブ還元に重要なセッションIDがLPのURLに含まれているため、LPのURLがコピーされて共有されると、ユーザに正しく還元されないなどの問題が出てきそう。  
- 今回の改修前からの問題だったとは思いますが、セッションIDの記録方法などを検討している際に気付けると良かったと感じる。
- LPのURLに別ユーザが直接アクセスしてくることは、正常なフローでは想定外ではありつつ、お得情報を共有したいというユーザ心理的にも可能性が高く、容易な行為だと思う。
- 自分だったらリダイレクタを間に挟んでセッションIDをCookieに保存し、LPでチェックするようにしそう。
  - 評価会中にかぬーが別のいいアイデアを出していた気もするけど、忘れてしまった。


## 能力向上に関するアドバイス

上記に記載した内容に関して、納得できるものがあれば取り入れていってもらえるといいなと思います。

また、解決手法や設計を考える際に、複数の選択肢を元に検討を進めることはできているので、特に理想だと思う選択肢を取らない判断をしたときには、その判断理由や将来的に理想状態に持っていくためにはどうしたらいいのかをもっと深掘って検討できていると良さそうに思いました。

さらにCARTA内には多くのエンジニアチームがあり、似たような対応を既に行っているチームがあることが多いので、部署を超えて事例を探したり相談できると、より選択肢の幅が広がるのではないかなと思いました。（他サービスにポストバックするシステムはZucksにも複数ある）

