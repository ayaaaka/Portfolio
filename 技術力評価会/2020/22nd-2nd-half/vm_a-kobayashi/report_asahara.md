# 技術力評価会 評価結果

- 被評価者: VM 小林彩花さん
- 評価者: Zucks あさはら

[評価資料](./README.md)

## 総評

仕様の策定から実装、本番への適用まるっと彩花さんが中心に行ってやり遂げたという内容だった。とても丁寧に仕事を進めていて安心感がある。

- 見積もりを細かくだして、検証も行っている
- 一から仕様を考えてすり合わせていく様はIssueからも伺えてとても良い
- Issueが見やすい

成果物についても、過去に発生した不正を防ぐ仕様になっていて、ASPとのトラブル防止の観点ではそれなりに意味のあるものになっていてとても良い仕事だった。

一方で、要望から仕様に落とすところで、何が要件でそれはなぜか、といった整理をもう少しつけてほしかった。
この実装に至ったのは、実は二つの要望によるものだった。

1. アドフラウドの防止
    - ECナビに対しての偽装を防御する
1. 調査のためのクリックイベントの記録

この二つが合わさって現在の仕様になったと理解しているが、要件を整理してそれぞれ解決する方向だと、また違った仕様案が出てきたように思う。そのあったかもしれない仕様案も加味した上で、この仕様がベストなのだと説明できたらよかった。
話を聞いていて、どれが本当に必要な機能だったのか、やるとに決めたこと、やらないとに決めたことの切り分けがよくわからなかった。

以下、もやもやしているところ。

- DBに保存して突合する処理のあたり
    - 現仕様では2年間保持するとのことだが、仕様案2では半年とブレがある
        - 仕様案2でDBにないものは手動でRedshiftの記録と照合することがある想定だった
        - そもそも目的が違うけど……
    - ハッシュで良いのではというコメントがあって、自分もそれに同意
       https://github.com/voyagegroup/ecnavi/issues/9673#issuecomment-628997362
       - 文字列制限については、hashの文字列切り詰めるとかやっても良かったと思う
           - あくまでも `ユーザID` `広告ID` `リクエスト日時` の組み合わせのバリデーションだけだし、hashの完全一致をみる必要なさそう
    - 要望2のために実装したとのことだったので、バリデーション目的の場合、この機能はおまけに思える
         - あとで追えるように、万一の時にECナビを確実に経由したかどうかわかる証拠があるだけでよかった？
         - あやかさん自身DBに記録とかあまりしたくなかったっていってたし

- クリックイベント記録
    - 調査目的もあってDBとRedshiftに記録するようにした
         - Redshiftは1日遅れでデータが上がってくる
         - 即時に見たいときのためにDBにも保存する
    - しかし、新規に対応したものだけで、既存のASPに対しては改修の優先順位は低く未対応
        - 本当に現段階で必要だったのかな……って思ってしまった
            - どれくらい使われているのか訊けばよかった
        - 評価会でも言ったけど、本当に必要なら既存のASPもクリックをログに記録するだけでもした方が良さそう


## 成長へのアドバイス

- 総評にもかいたが、丁寧な仕事ぶりでとてもすばらしいので、これからも続けて行って欲しい。
- システムを作るときは最初に仕様を考えるのではなくて、要件を確認して進めるとよさそうに思う。
例えば、 [Issue](https://github.com/voyagegroup/ecnavi/issues/9673) も最初に仕様案をだすのではなく、要件を洗い出してそれが過不足ないか複数人で確認するといったかんじだ。
複数の要望がある場合はまず一つ一つ必要なことを洗い出して、一つのシステムとして対応した方がいいのかどうかをまず検討してほしい。


## その他

- トラッキングIDが重複したら503が返ってしまう
    - https://github.com/voyagegroup/ecnavi/pull/9638/files#diff-4d889f7cb906a18a81c6868ee9776c1d6e18d02071119200e590ddaa310846dfR71
    - 頻度は低いかもしれないけど、重複はあるものとみなして再生成するほうがUX的によかったかも

- イベントの記録先がMySQL
    - 管理するリソースを増やしたくないという部署の方針だったぽい
    - DynamoDBを三回提案して却下されたとのことだけどもう少し詳細をききたかった
        - 却下されたのは、管理リソースを増やすという欠点を打ち消すような利点がなかったから？
        - 単純に崩せない部署の方針？
    - DynamoDBやRedisを使えたら別のアプローチもあったよなって思う

- 資料の最初にシーケンス図がほしかった
    - 評価会中で訊いたのでOKだったけど、資料だけみるとどこからのリクエストでどういうパラメータが渡ってくるといったフローがわかりづらかった

- 実際にどれくらい不正を弾くことができたのかの話があればよかった
    - なかったならそれはそれでいい話
    - バリデーションエラーの時にSlack通知がとんでくるとのことだったが、それがどう活用されてるのかみたいな話もききたかった
        - 1日何件ぐらいとんでくる、とか
        - 不備があった場合のアクションは、とか

- PULL型は不正が0っていってたので、それでよくない？ ってちょっと思ってしまった
    - 即時制の問題については、10分に1回処理を走らせるみたいに頻度をあげて対応する等でカバーできるように思う


## 評価会フィードバック後の補足

不正の話を長々としていたけど、個人的には過去あった不正への対策としてやったことについては納得感があった。

総評でもかいたが、個人的に気になっていたのは、目的が違うものを混ぜて対応したことそのもので、それがベストな対応だったのかの検討がなかったことだった。自分ならおそらく別々に対応してしまうし、不正対策のための仕様はもっとシンプルにしていたと思う。

細かいところについても、それは本当に必要なのか？　というところの検討をして欲しいし、検討したのなら説明がほしかった。

- イベントを `当日` Redashでみたい
    - 当日みるためにDBにいれる、という要件がでてきた
         - 当日でなければRedshift使えば見えるようにできるぽい？
    - 現実は2 - 3日ぐらいのスパンでイベントをみている、という話をした
        - なので1日遅れでもそんなに問題にならなそう？
        - あるいは当日みえなければどれくらい困るのか？
        - 現状他のASPだととれてないので、当日のログは本当にその速度が必要になってからでよかったかも

その他のその他

- クリックイベント既存のASPもとればいいのでは -> 部署が違うから無理
- 不正対策やってる時に、 `ついでに調査用イベントログもとってほしい` という要望がお上から降りてきた 
