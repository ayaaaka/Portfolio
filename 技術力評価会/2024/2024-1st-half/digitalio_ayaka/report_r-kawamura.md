# 技術力評価会　評価結果

* 被評価者: DIGITALIO 小林 彩花
* 評価者: CARTA MARKETING FIRM 河村 綾祐

[評価資料](./)

## 総評

ASPや代理店方面への成果通知の連携で都度エンジニアが対応していたが、冗長なコードを生み出し続けていた部分を管理画面化することで対応工数をゼロにしたお話でした。このお話のよかったところは評価してほしいポイントにしっかり書いてある通りですね。エンジニアリングチームだけに留まらず、AFFI Unitとのコミュニケーション（e.g. むにゃる会、Redash勉強会、効果計測の流れ（だったかな））も率先して取るようにしており、会中でも自身が言っていましたが「フルサイクルエンジニアリング」してるのがわかる評価会で、頼もしさの片鱗を伺うことができました。

また移行についても、検証を含めて考えながら走ることができているとのことでした（e.g. glossom）。ここは意識しないと後回しにされがちになるので、冗長なコードの削除も手を止めることなく完遂できそうな期待があります。

更にこの話の流れから、合意を取った上で基盤の改善（e.g. ナビのコードベース）に乗り出していくということも聞くことができたので、あやかの動きがUnit内に波及して良い流れになっていることが想像できました。

わたしの[意地悪な問いかけ](#q-めちゃくちゃ意地悪な質問するけどビジネスサイドにconfigとclassを追加してもらうこともできたのでは可能な限り簡素な状態にしてしまった上で)にも、根拠を持って回答してくれたのもよかったです。関わるメンバの様々な習熟度を考慮した上で選択をしていたことから、Unit内の解像度が高い状態で業務に取り組めていることが伺えました。

一方で[revertしたPR](https://github.com/voyagegroup/ecnavi/pull/18325)にどういう経緯で気づいたのか、という質問をさせてもらったときのアクションの仕方には改善の余地があるな〜と思ったのでこれは後述します。

### 余談

会後に「そういえばzaffiでもなんか管理画面化の事例あったな？」と思ったので貼っておきます。

[zaffiのCV通知口設定機能](https://github.com/voyagegroup/zaffi/issues/6688)

あやかの仕事と完全一致していました。ASP界隈あるあるなのだろうか笑

## 評価者が被評価者の状況ならこう考える、こう動く

コミュニケーションを通して相手を理解する、啓蒙していくあるいは巻き込んでいく、というのが高いレベルで実現できているからこそ、もう少し細かいところに目を向けてみてはどうでしょう。

### コードベースや開発環境にも影響を出していく

上記のrevertしたPRのところです。会中に「phpのFatalエラーがSlackに届いたので失敗に気付いた」という発言がありました。ミスは誰にでもあります。今回はひとまずbizと調整して再取込なしで支払いで辻褄を合わせるということができたのはとりあえず一安心でした。ただ質問しなければ出てこなそうな雰囲気だったので、何をきっかけにrevertしたのかはPRにあると良さそうですね。

また、エラー自体も動作確認中に気づいてはいたものの、修正commitを行う前に本番に反映してしまっていた、というところにちょっと引っかかりを覚えました。ぶっちゃけパラメータの `array` の消し忘れではあったのですが、これを回避する術はなかったのかな〜と。この問題をTechUnitで話したということで、phpdocからtypehintというのも一つの取りうる予防策だとは思いました。

あとは例えばCIでphpstan（level = 2で入れているのは確認しました）をもう少し高いレベルで動かせていたら回避できていた？どうだろう。[level = 5](https://github.com/phpstan/phpstan-src/blob/1.11.x/conf/config.level5.neon)だとメソッド・関数の引数型チェックまではできそうでした。（でもecnaviのcomposerを見たらphpstanがちょっと古いバージョンそうでした）

コードベースが辛いのは歴史も長いしそれはそうなので、全体に波及させるような対策をガッと気合でやるのはちょっと重そうなのはわかります。例えば特定のディレクトリ配下だけチェックするようにできないかとかはあらたも言っていましたね。2度と同じようなミスを（自分以外も）しないように振る舞うというのも、リーダーの取りうる行動の一つだと思います。

具体的に書くと以下のところはわたしなら粛々とやりそうです。

* ガーデニング
* 静的解析の適用（適用判断）
* typehintの適用

## 能力向上に関するアドバイス

### 自身の強み x 狭義の技術

これからAffiUnitで扱う機能の基盤部分の改善に入っていくということだったので、上記のようなことも考えつつ取り組んでいく（もちろんTechUnit内での合意は必要だとは思うのですが）とよりよい改善活動になると思うので一考してみてください。

あやか個人がやるのはそうなのですが、チームを巻き込んで推進することはこの評価会を見る限り可能だと思うので、そういった改善アイデアやあるべき姿を常に持っておく・考えておくことで、（今回のテーマのように）ふとしたときに機運を高めてガッとやる、という形に落とせるとあやかのよい部分を活かしながら技術的なところにもイニシアチブを取っていけるのではないかと考えました。

### アフィリエイトを取り巻く環境への理解を深め、それをシステムへ活かす

これは一つの例ですが、会中にアフィリエイトを取り巻く環境（e.g. ITP; Intelligent Tracking Prevention）の話もしましたが、深い理解があるようには受け取れませんでした。ここでもう一歩、なぜタグ計測だとドロップしてしまうのかという技術的な理解が進むと、ソケット計測を推進していく根拠にもなりうると思います。

そういったものにも目を向け、眼の前のコード・アーキテクチャの課題に向き合うだけでなく、変化し続けるユーザ環境にも対応していくには、なども考えながら動けるとより一層よさそうです。

----
（以降は任意）

## 事前メモ

### Q. この依頼は従来はどれくらいの頻度で飛んでくるものだった？つまりどれくらいの困り度だった？

エンジニアからは困り度が全く読めない

biz的には月末だから大事なんだよ！が（エンジニアに）伝わらない（これは別の課題）

### Q. 連携のたびに追加されていたコードは消した？消してない場合はいつ消していくのか

移行テスト中のglossomは消した！

これが終われば順次移行して消してくぞ！

### Q. （めちゃくちゃ意地悪な質問するけど）ビジネスサイドにconfigとclassを追加してもらうこともできたのでは？可能な限り簡素な状態にしてしまった上で

わからんくもない

（ここでAffiUnitの現状と人々の様子を詳しく聞いた）

人々に対して自分の（エンジニアとしての）責務を押し付けるのは違うな、と判断

### Q. 一回[これ](https://github.com/voyagegroup/ecnavi/pull/18288)をrevertしてるけどどういう経緯で気付いたの

PHP Fatal エラーログに流れてきた

2件通知エラーになってしまった

復旧はせず

bizと握って支払いのときに辻褄を合わせた

なんで気付けなかったん？

修正したものはあったんだけど、commit漏れ

再発防止をTechUnitの一門会で話してみた

動作確認しよう

phpdocじゃなくてtypehint使ってこ

静的解析？phpstanは入れてるが古のコードがあるので全体的に適用レベルが低くなっている

## 当日メモ

ソケット連携

サーバーサイドでの連携を行うパターン

全体に占める割合: 3割

タグ連携

今回はこちらじゃない、LPやthanksページから直接メディアに通知するパターン

全体に占める割合: 7割

ITPで取り漏れるケースがある <- これがソケットにできると漏れがなくなる

ITPよくわからん by ayaka, arata

タグ連携の管理画面の話

「配信数」がなんなのかわからない

CID: クライアントID

BID, SIDはマジで意味わからん、使ってない

AffiUnitはユーザ獲得、ECナビに広告掲載させる、エンジニアたちの3チーム

IF = インフルエンサー

略語〜〜〜

対応工数自体は大した事ないが、月末に予算消化をしたいという理由でリクエストが多かったりする（ことがある）

AffiUnitになってからは漏れがないが、TechUnitが与件を取って仕事をするような時代（〜2023夏）は月1-2件の対応漏れがあった

Unit内のタスクも消化し切って、次何やるか、のタイミングでぐいっといった

広告出稿が終了している連携先もコードとして残ってしまっていた

ユーザIDハッシュ化については新しい方に切り出して作った

JSONカラムの使い所？

ECナビのA/Bテストで使ってたりする

Affiについてからビジネスサイドの定例（ASPチーム、ユーザチーム、AffiUnit（両チーム））に全部出た

エンジニアも全員引き込んだ

定例の雰囲気はAffiUnitのリーダー米村さんしか話してなかった

コミュニケーションが課題だなと判断

→むにゃる会（TechUnitでやってる会を真似た）

ここでソケット連携の位置付けなどを知ることができた

ビジネスサイドへの効果

redashのところ

クエリ書けないから依頼がエンジニアに飛んでくるのがなくなった（レビューは来る

bizが自分たちでできることが増えた！

更に共通言語でしゃべれるようになった

しばらくは管理画面は一緒に使っていきましょうとなっている

### Q. 前回の評価会から自分が成長したと思うポイント

動き回る範囲、判断の素早さ、周りに働きかける

（物事を多角的に見られるようになった結果）自分以外の人々の仕事に突っ込んでいくようになった

広義の技術力は意図して動いてきた = フルサイクルを体現してきた

狭義の技術力も評価会外だがやってきた

フロントとインフラ、こちらも成長はし続けられている
